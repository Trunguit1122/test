Security Test Cases,,,,,,,,,,,
,,,,,,Passed,0,,,,
,,,,,,Failed,0,,,,
,,,,,,Not Run,90,,,,
,,,,,,Not Completed,0,,,,
,,,,,,Number of test cases,90,,,,
,Category,Test Case ID,Test Case Description,PreRequisites,Steps,Test Procedures,,Test Case Expected Result,Actual Result,Status,Note
,,,,,,Steps to Perform,Step Expected Result,,,,
,REQ008,SEC-001,Verify Account Lockout Trigger (5 Failed Attempts),Account user@test.com is Active.,1,"Enter correct Email and Wrong Password (Attempt 1). Click ""Sign In"".",System displays error MSG-005,System locks the account after exactly 5 consecutive failed attempts and displays MSG-007.,,Not Run,
,,,,,2,"Repeat step 1 for Attempts 2, 3, and 4.",System displays error MSG-005,,,,
,,,,,3,Enter Wrong Password (Attempt 5) within 10 minutes of Attempt 1.,"System displays error MSG-007: ""Too many failed attempts. Account locked for 15 minutes.",,,,
,,SEC-002,Verify Login Denial during Lockout Period,Account is currently Locked due to 5 failed attempts.,1,Immediately enter Correct Password.,Input accepted.,System prevents login even with correct credentials during the 15-minute lockout.,,Not Run,
,,,,,2,"Click ""Sign In"".",System displays error MSG-007,,,,
,,SEC-003,Verify Lockout Expiration (Auto-Unlock after 15 mins),Account was locked 16 minutes ago.,1,Wait for 16 minutes (Exceeding the 15-minute lockout).,Timer expires.,System automatically unlocks the account after 15 minutes.,,Not Run,
,,,,,2,"Enter Correct Password. Click ""Sign In"".",Login successful. Redirect to Dashboard.,,,,
,,SEC-004,Verify Failed Attempt Counter Reset (Successful Login),Account user@test.com is Active.,1,Enter Wrong Password 4 times.,System displays error MSG-005,Counter resets to 0 after a successful login.,,Not Run,
,,,,,2,Enter Correct Password (Attempt 5).,Login successful. Redirect to Dashboard.,,,,
,,,,,3,Logout and enter Wrong Password 1 time.,System displays MSG-005 (Not Locked).,,,,
,,SEC-005,Verify Failed Attempt Counter Reset (Time Window Expiry),Account user@test.com is Active.,1,Enter Wrong Password 4 times.,System displays error MSG-005,Counter resets if the time between attempts exceeds 10 minutes.,,Not Run,
,,,,,2,Wait for 11 minutes (Exceeding the 10-minute window).,Window expires.,,,,
,,,,,3,"Enter Wrong Password (Technically the 5th attempt, but time expired).",System displays MSG-005 (Account is NOT locked).,,,,
,,SEC-006,Verify Lockout Message Content,User triggers lockout.,1,Perform 5 failed login attempts.,Lockout triggered.,The error message must match SRS content exactly.,,Not Run,
,,,,,2,Observe the error message on the 5th attempt.,"Message matches MSG-007: ""Too many failed attempts. Account locked for 15 minutes.""",,,,
,,SEC-007,Verify Lockout Persistence across Browsers,Account user@test.com is Active.,1,Trigger lockout on Chrome.,Account locked on Chrome.,"Lockout is applied at the Database/Account level, not just the browser.",,Not Run,
,,,,,2,Open Firefox immediately. Enter Correct Password.,Input accepted.,,,,
,,,,,3,"Click ""Sign In"" on Firefox.",System displays error MSG-007 (Login denied).,,,,
,,SEC-008,"Verify ""Forgot Password"" functionality during Lockout",Account is Locked.,1,"Click ""Forgot Password?"".",Page redirects.,"User should still be able to request a password reset even if locked (Standard security practice, though check specific business logic).",,Not Run,
,,,,,2,Enter Email and Request Reset Link.,System sends email (MSG-008).,,,,
,,SEC-009,Verify Boundary: 4 Failed Attempts,Account is Active.,1,Enter Wrong Password 4 times consecutively.,MSG-005 shown 4 times.,Account remains Active after 4 attempts.,,Not Run,
,,,,,2,Check Account Status in DB.,Status is still 'Active'.,,,,
,,SEC-010,Account user@test.com exists.,Account is Active.,1,Enter wrong@email.com (Non-existent) 5 times.,System displays MSG-005.,Lockout should typically ONLY count failures for a valid existing username. (Brute force is against a specific target).,,Not Run,
,,,,,2,Enter user@test.com with Correct Password immediately.,"Login successful. (The 5 failures were for a ghost account, shouldn't lock the real user).",,,,
,REQ009,SEC-011,Verify response for Existing Email (Happy Path),Account user@test.com exists.,1,"Enter user@test.com. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-012,Verify response for Non-Existing Email (Ghost User),Email ghost@test.com does NOT exist.,1,"Enter ghost@test.com. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-013,Verify response for Locked Account Email,Account locked@test.com exists but is Locked.,1,"Enter locked@test.com. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-014,Verify response for Inactive/Banned Email,Account banned@test.com is Inactive.,1,"Enter banned@test.com. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-015,Verify response for Invalid Email Format,User is on Forgot Password page.,1,"Enter invalid-email. Click ""Submit""",System shows MSG-001 (Format check usually runs before Existence check).,System displays Format Error (MSG-001) ,,Not Run,
,,SEC-016,Verify response for Case-Insensitive Email,Account user@test.com exists.,1,"Enter USER@TEST.COM. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-017,Verify response time difference (Timing Attack),Tool: Stopwatch/Network Log.,1,Submit existing email and measure response time.,Time T1 recorded.,T1 and T2 must be approximately equal (Difference < 500ms) to prevent Timing Attacks.,,Not Run,
,,,,,2,Submit non-existing email and measure response time.,Time T2 recorded.,,,,
,,SEC-018,Verify response with SQL Injection payload,User is on Forgot Password page.,1,"Enter ' OR 1=1 --. Click ""Submit"".",Input accepted.,"System displays MSG-008 (Sanitized) or Format Error, NEVER a Database Error.",,Not Run,
,,SEC-019,Verify response with Leading/Trailing spaces,Account user@test.com exists.,1,"Enter user@test.com. Click ""Submit"".",Input accepted.,"System displays MSG-008: ""If this email exists, a password reset link has been sent.""",,Not Run,
,,SEC-020,Verify multiple requests behavior (Spamming),Account user@test.com exists.,1,"Click ""Submit"" 5 times rapidly.",Requests sent.,"System displays MSG-008 each time: ""If this email exists, a password reset link has been sent.""",,Not Run,
,REQ010,SEC-021,Verify Token validity within time limit (Happy Path),Link generated 1 minute ago.,1,Click the reset link in email.,Link opens.,"System accepts token and shows ""Set New Password"" page.",,Not Run,
,,SEC-022,Verify Token validity at Upper Boundary (Valid),"Link generated 14 minutes 50 seconds ago.
",1,Click the reset link.,Link opens.,System accepts token.,,Not Run,
,,SEC-023,Verify Token validity at Upper Boundary (Expired),Link generated 15 minutes 01 seconds ago.,1,Click the reset link.,Link opens.,"System rejects token, shows ""Link Expired"" error.",,Not Run,
,,SEC-024,Verify Token expiry after long duration,Link generated 24 hours ago.,1,Click the reset link.,Link opens.,"System rejects token, shows ""Link Expired"" error.",,Not Run,
,,SEC-025,Verify One-Time Use (Replay Attack),User just successfully reset password using this link.,1,Click the same reset link again immediately.,Link opens.,"System rejects token, shows ""Link already used/Invalid"".",,Not Run,
,,SEC-026,Verify Old Token Invalidation,"User requested Link A, then requested Link B.",1,Click Link A (The older one).,Link opens.,System rejects Link A (since Link B is the active one).,,Not Run,
,,SEC-027,Verify Old Token Invalidation,Valid link exists.,1,Modify one character in the token string in URL.,Enter URL.,"System rejects token, shows ""Invalid Link"".",,Not Run,
,,SEC-028,Verify Token usage with Wrong Account,Token belongs to User A.,1,Try to use Token A to reset User B's password (via API manipulation).,Request sent.,System rejects mismatch between Token and User ID,,Not Run,
,,SEC-029,Verify Token usage on Locked Account,User A is locked. Link generated before lock?,1,Click reset link for a Locked account.,Request sent.,"System shows ""Account Locked"". Safe to assume reset allowed to recover account",,Not Run,
,,SEC-030,Verify Token persistence after Server Restart,"Link generated, then Server restarted.",1,Click reset link.,Request sent.,System accepts token ,,Not Run,
,REQ016,SEC-031,Verify Skill Selection with Valid Session (Happy Path),User is logged in. Session is active.,1,"Click on ""Speaking"" or ""Writing"" card.",System validates session successfully.,System allows access and navigates to the practice page.,,Not Run,
,,,,,2,Observe page navigation.,User is redirected to /practice/speaking or /writing.,,,,
,,SEC-032,Verify Skill Selection with Expired Session (Time Limit),"User logged in, but left idle > Session Timeout (e.g., 30 mins).",1,"Click on ""Speaking"".",System detects expired session.,"System denies access, redirects to Login page and shows MSG-019.",,Not Run,
,,,,,2,Observe system response.,Redirects to Login page. Error MSG-019 displayed.,,,,
,,SEC-033,Verify Error Message Content,Session is expired/invalid.,1,Trigger the redirect,Error displayed.,"The error message must match exactly MSG-019: ""Your session has expired. Please log in again.""",,Not Run,
,,,,,2,Read the error message text.,Text matches MSG-019.,,,,
,,SEC-034,Verify Skill Selection after Manual Token Deletion,User logged in. F12 -> Delete Session Cookie/Local Storage.,1,Delete the access_token or session cookie in browser.,Token removed.,System detects missing token -> Treats as Unauthenticated -> Redirects to Login with MSG-019.,,Not Run,
,,,,,2,"Click on ""Writing""",Redirects to Login.,,,,
,,SEC-035,Verify Skill Selection with Tampered Token,User logged in. Edit token char in Local Storage.,1,Modify one character in the JWT token.,Token invalid signature.,System fails to verify token signature -> Redirects to Login with MSG-019.,,Not Run,
,,,,,2,"Click on ""Speaking"".",Redirects to Login.,,,,
,,SEC-036,Verify Skill Selection across Multiple Tabs (Logout Scenario),Open Dashboard in Tab A and Tab B.,1,Log out in Tab A.,Session ended.,Clicking skill in Tab B should trigger BR16 immediately -> Redirect to Login.,,Not Run,
,,,,,2,"Switch to Tab B. Click ""Speaking"".",System detects session invalidated.,,,,
,,SEC-037,Verify Post-Login Redirection (User Experience),"User clicked ""Speaking"" -> Kicked to Login.",1,Enter credentials and Log in again.,Login success.,"System should ideally redirect user BACK to ""Speaking"" (Intended URL), not Dashboard.",,Not Run,
,,,,,2,Observe redirection.,Redirects to /practice/speaking.,,,,
,,SEC-038,Verify Browser Back Button into Practice Page,"User logged out. Click ""Back"" button to Practice page.",1,Log out. Press Browser Back button.,Browser loads cached page or requests server.,System performs Auth Check on load -> Redirects to Login (Access Denied).,,Not Run,
,,,,,2,Observe behavior.,Cannot view Practice content.,,,,
,,SEC-039,Verify Server Restart (Session Persistence Check),User logged in. Server restarts.,1,Restart the Backend Server.,Server up.,Access Allowed.,,Not Run,
,,,,,2,"Click ""Speaking"".",Access Allowed.,,,,
,,SEC-040,Verify Auth Check on API Request (Backend Layer),User captures the API request (e.g. GET /api/prompts).,1,Send API request without Token via Postman.,Request sent.,API responds with 401 Unauthorized or 403 Forbidden.,,Not Run,
,,,,,2,Check API Response.,Status 401/403.,,,,
,REQ022,SEC-041,Verify Permission Request Trigger (First Time),User is on Recording page. Permission not yet granted.,1,"Click ""Start Recording"".",Browser native popup appears asking for Microphone access.,"System shows ""Account Locked"". Safe to assume reset allowed to recover account",,Not Run,
,,SEC-042,"Verify ""Allow"" Action (Happy Path)",User clicks Start.,1,"Click ""Allow"" on the browser popup.",Browser grants access.,System detects permission granted and enables the Microphone (Recording starts/Icon changes).,,Not Run,
,,SEC-043,"Verify ""Block/Deny"" Action (Negative Case)",User clicks Start.,1,"Click ""Block"" on the browser popup.",Browser denies access.,"System detects denial and displays error MSG-012: ""Microphone access denied..."".",,Not Run,
,,SEC-044,Verify MSG-012 Content & UI,Permission blocked.,1,Trigger Block scenario. Check the error modal.,Modal visible.,"Error message text must match MSG-012 exactly. Buttons ""Retry"" and ""Cancel"" are visible",,Not Run,
,,SEC-045,"Verify ""Retry"" Button Logic on Error Modal",MSG-012 is displayed.,1,"Click ""Retry"" button.",Action triggered.,System attempts to request permission again (or directs user to settings).,,Not Run,
,,SEC-046,"Verify ""Cancel"" Button Logic on Error Modal",MSG-012 is displayed.,1,"Click ""Cancel"" button.",Modal closes.,"System returns to the initial ""Ready"" state without crashing.",,Not Run,
,,SEC-047,Verify Persistent Block (Browser Setting),"Browser is set to ""Always Block"" this site.",1,"Click ""Start Recording"".",No popup appears.,System immediately detects restricted access and shows MSG-012.,,Not Run,
,,SEC-048,Verify HTTP vs HTTPS Restriction,App running on HTTP (Insecure).,1,"Click ""Start Recording"".",Browser auto-blocks.,System handles the security error and shows MSG-012 (Modern browsers require HTTPS for Mic).,,Not Run,
,,SEC-049,Verify Hardware Missing (No Mic),Machine has no Mic input.,1,"Click ""Start Recording"".",Browser/OS reports error.,System handles NotFoundError gracefully (shows generic error or MSG-012).,,Not Run,
,,SEC-050,Verify Hardware Missing (No Mic),Permission denied.,1,"Reload page. Click ""Start"" again.",Action triggered.,"System re-evaluates permission (should ask again or stay blocked depending on browser preference), ensuring no infinite loops.",,Not Run,
,REQ033,SEC-051,Verify access to assigned student profile (Positive Case),"1. Teacher A is logged in.

2. Teacher A manages ""Class 101"".

3. Student X is currently enrolled in ""Class 101"".",1,Teacher A clicks on Student X's name from the Student List.,System validates permission successfully.,System navigates to Student X's profile page and displays full details.,,Not Run,
,,,,,2,Check the profile page content.,"Profile, goals, and overview of Student X are visible.",,,,
,,SEC-052,Verify access denial for unassigned student (Negative Case),"1. Teacher A manages ""Class 101"".

2. Teacher B manages ""Class 102"".

3. Student Y is in ""Class 102"" (Not in Class 101).",1,"Teacher A attempts to access Student Y's profile (e.g., via direct URL or search result glitch).",System checks permission and detects mismatch.,"Access is denied. System displays MSG-020: ""Access denied. You do not have permission to view this resource""",,Not Run,
,,,,,2,Verify the page content.,The profile content is NOT loaded/hidden.,,,,
,,SEC-053,Verify Direct URL Access (IDOR Protection),"1. Teacher A is logged in.

2. Teacher A knows the ID of Student Z (who belongs to another teacher's class).",1,Teacher A manually types the URL: /student/profile/{Student_Z_ID} in the browser address bar.,System intercepts the request.,System blocks the request and displays MSG-020 or redirects to a 403 Forbidden page.,,Not Run,
,,,,,2,Press Enter to load.,No student data is revealed.,,,,
,,SEC-054,Verify access after student is removed from class,"1. Student X was in Teacher A's class.

2. Student X has just been removed/transferred out of Teacher A's class.

3. Teacher A is still on the Student List.",1,Teacher A clicks on Student X's name (if still cache-visible) or uses a bookmark.,System re-evaluates permission at the time of click.,Access is now denied. System displays MSG-020.,,Not Run,
,,,,,2,Check reaction.,Profile does not load.,,,,
,,SEC-055,Verify access after student is added to class,"1. Student Y was originally in another class.

2. Student Y is newly transferred into Teacher A's class.

3. Teacher A is logged in.",1,Teacher A searches for Student Y and clicks on the profile.,System validates that Student Y is now linked to Teacher A.,Access is granted. Teacher A can view Student Y's profile immediately.,,Not Run,
,,,,,2,Verify data visibility.,All profile details are visible.,,,,
,,SEC-056,Verify access for Teacher managing multiple classes,"1. Teacher A manages both ""Class A"" and ""Class B"".

2. Student S1 is in Class A.

3. Student S2 is in Class B.",1,Teacher A clicks on Student S1's profile.,Access granted.,Teacher A can view profiles of students from ALL classes they manage (S1 and S2).,,Not Run,
,,,,,2,Teacher A clicks on Student S2's profile.,Access granted.,,,,
,,SEC-057,Verify message content MSG-020,"1. Teacher A attempts to access an unauthorized student profile.

2. The error popup/page is displayed.",1,Read the text of the error message displayed.,The text matches the SRS specification.,"The message displays exactly: ""Access denied. You do not have permission to view this resource.""",,Not Run,
,,,,,2,"Check for a ""Go Back"" button (as per MSG-020 description in SRS).","A ""Go Back"" or ""OK"" button is present.",,,,
,,SEC-058,Verify navigation after closing error message,1. MSG-020 is currently displayed on the screen due to unauthorized access attempt.,1,"Click the ""Go Back"" (or Close) button on the message dialog.",The dialog closes.,System redirects the user back to the Student List or the previous valid page.,,Not Run,
,,,,,2,Verify the current page URL.,"User is returned to a safe page (e.g., /student-list).",,,,
,,SEC-059,Verify Co-Teacher access (If supported),"1. ""Class Shared"" is assigned to BOTH Teacher A and Teacher B.

2. Student M is in ""Class Shared"".",1,Teacher A logs in and accesses Student M.,Access granted.,Both teachers can view the profile of the same student if they both manage the class.,,Not Run,
,,,,,2,Teacher B logs in and accesses Student M.,Access granted.,,,,
,,SEC-060,Verify access when Teacher has NO classes assigned,"1. Teacher NewAccount has just been created.

2. No classes are assigned to this teacher yet.

3. Database has existing students.",1,Teacher attempts to access any student profile URL directly.,Permission check fails for all students.,Teacher cannot view ANY student profiles. MSG-020 appears for all attempts.,,Not Run,
,,,,,2,Check Student List.,"List should be empty (or access denied), preventing click.",,,,
,REQ048,SEC-061,Verify UI Blocking for Duplicate Writing Session,Learner is logged in and already has an active Writing session (Status: In Progress). Learner is on the Topic Selection page.,1,"Select a Writing topic and click the ""Start Practice"" button.",The system checks the user's active session status.,"System displays the MSG-023 modal (""You already have an active session...""). No new session is created.",,Not Run,
,,,,,2,Observe the screen content.,"The modal remains visible, blocking entry to a new session.",,,,
,,SEC-062,"Verify ""Deep Link"" Bypass Prevention (URL Manipulation)","Learner has an active Writing session. Learner knows the direct URL pattern to create a new session (e.g., .../writing/start/new).",1,Paste the direct URL for creating a new session into the browser address bar.,Browser sends the request to the server.,System redirects the user back to the existing Active Session OR displays the MSG-023 error page. User cannot bypass via URL.,,Not Run,
,,,,,2,"Press ""Enter"" to load the URL.",The new session page is NOT loaded.,,,,
,,SEC-063,Verify Cross-Skill Concurrency (Reading vs Writing),Learner has an active Writing session. Learner navigates to the Reading skill section.,1,Select a Reading topic.,The Reading topic details are shown.,System allows the new Reading session to start successfully. No MSG-023 is displayed because skills are independent.,,Not Run,
,,,,,2,"Click ""Start Practice"" for the Reading test.",The Reading interface loads successfully with a new AttemptID.,,,,
,,SEC-064,"Verify ""Zombie"" Session Handling (Browser Force Closed)","Learner started a Writing session previously but closed the browser without submitting. The session is still ""In Progress"" in DB.",1,"Re-open the browser, log in, and navigate to the Writing Topic Selection page.",The page loads successfully.,"System displays MSG-023 when clicking start, correctly identifying the previous un-closed session.",,Not Run,
,,,,,2,"Click the ""Start Practice"" button.",The MSG-023 modal appears.,,,,
,,SEC-065,"Verify ""Discard"" Action in MSG-023 cleans up session",The MSG-023 modal is currently displayed. The active session is unwanted.,1,"On the MSG-023 modal, click the ""Go to Session"" button.",System redirects to the unfinished session.,"After discarding the old session, the user can successfully start a new session without error.",,Not Run,
,,,,,2,"Inside the session, click the ""Discard"" (or Cancel) button.",System cancels the session (Status -> Cancelled) and returns to list.,,,,
,,,,,3,"Click ""Start Practice"" again for a new topic.",A new session starts successfully.,,,,
,,SEC-066,Verify API Level Blocking (Postman/Curl),Learner has an active Writing session. Tester has API access tokens.,1,Open Postman and set up a POST request to the session creation endpoint.,The tool is ready to send.,"The API response is 409 Conflict (or 400 Bad Request), containing the MSG-023 error code/text.",,Not Run,
,,,,,2,Send the Request.,The server responds with the error code.,,,,
,,SEC-067,Verify Timeout Edge Case (Session Expired but not Closed),"Learner has a session where the timer has run out (e.g., > 60 mins), but Submit was never clicked.",1,Navigate to the Topic Selection list.,List loads.,"System still blocks (MSG-023) because the session status is technically still ""In Progress"" until finalized by the system.",,Not Run,
,,,,,2,"Click ""Start Practice"" for a new topic.",The MSG-023 modal appears.,,,,
,,SEC-068,"Verify ""Go to Session"" with Deleted Data (Corruption Check)","MSG-023 appears claiming session #101 is active. However, record #101 was manually deleted/corrupted in the DB.",1,"Click ""Go to Session"" on the MSG-023 modal.",System attempts to fetch session #101.,"System redirects to a ""Not Found"" page (404) or auto-clears the invalid session state (Self-healing). It does not hang.",,Not Run,
,,,,,2,Observe the behavior.,An error page or Dashboard is shown.,,,,
,,SEC-069,"Verify Admin/Teacher ""View as Student"" (Impersonation)","Teacher is using ""View as Student"" feature for Student A. Student A has a real active session on another device.",1,"As the Teacher (impersonating), click ""Start Practice"".",System checks permissions for Student A.,"System displays MSG-023. The restriction is bound to the Student ID entity, ensuring data integrity for the real student.",,Not Run,
,,,,,2,Observe the result.,The blocking modal appears.,,,,
,,SEC-070,Verify Multi-Tab Race Condition,"Learner has no active session. Learner has opened two tabs on the ""Start Practice"" screen.",1,"Click ""Start"" on Tab A.",Tab A creates a session.,Only one tab successfully creates a session. The second tab either redirects to the first session or shows MSG-023.,,Not Run,
,,,,,2,"Immediately click ""Start"" on Tab B (within 1-2 seconds).",Tab B detects the session created by Tab A.,,,,
,REQ065,SEC-071,Verify Access Token Reuse Prevention after Logout,User is logged in. Tester has captured the valid Access Token (JWT) using DevTools/Postman.,1,"Click the ""Logout"" button to end the session.",The system redirects to the Login Page.,Any subsequent API request using the captured Access Token returns HTTP 401 Unauthorized.,,Not Run,
,,,,,2,"Use Postman to send a GET request to a protected endpoint (e.g., /api/user/profile) using the captured Token.",The API responds with HTTP 401 Unauthorized (or 403 Forbidden).,,,,
,,SEC-072,Verify Refresh Token Reuse Prevention after Logout,User is logged in. Tester has captured the Refresh Token.,1,"Click the ""Logout"" button.",The system redirects to the Login Page.,The Refresh Token is invalidated on the server. Attempting to get a new Access Token fails.,,Not Run,
,,,,,2,Use Postman to call the /api/auth/refresh endpoint using the captured Refresh Token.,The API responds with HTTP 401/403 (Invalid Token).,,,,
,,SEC-073,Verify Token Invalidation on Password Change,User is logged in on Device A (Token A). User changes password on Device B.,1,Change the password successfully on Device B.,System confirms password change.,Token A on Device A becomes invalid immediately (or within short window). Device A is forced to re-login.,,Not Run,
,,,,,2,"On Device A, try to navigate/refresh the page using the old Token A.",The system redirects Device A to the Login Page (API returns 401).,,,,
,,SEC-074,Verify Client-Side Restoration Attack (Local Storage),User is logged in. Tester copies the Token from Local Storage.,1,"Click ""Logout"".","Local Storage is cleared, user is redirected.","Even if the Token is manually restored in the browser, the Server rejects it.",,Not Run,
,,,,,2,Manually paste the copied Token back into the browser's Local Storage/Cookie.,The Token is saved in the browser.,,,,
,,,,,3,Refresh the page (trying to access Dashboard).,The system detects the invalid token (Server-side check) and redirects to Login.,,,,
,,SEC-075,"Verify ""Blacklist"" Mechanism (if implemented)","User logs out. The Token has NOT expired by time (e.g., valid for another hour).",1,"Click ""Logout"".",User is logged out.,"The Token is explicitly added to a deny-list (Blacklist) on the Redis/DB, preventing access despite valid timestamp.",,Not Run,
,,,,,2,Call an API with the token immediately.,The API rejects the request.,,,,
,,SEC-076,Verify Concurrent Session Invalidation (Change Password),"User selects ""Logout from all devices"" (if available) or changes password.",1,"Trigger ""Change Password"" action.",Success message appears.,All active tokens for this user ID across all devices are invalidated.,,Not Run,
,,,,,2,Check session on a secondary device.,The secondary device is logged out upon the next action.,,,,
,,SEC-077,Verify Token Expiration vs Invalidation,"User waits for the Token to expire naturally (e.g., 30 mins).",1,Wait for the Token expiration time to pass without refreshing.,Time elapses.,This confirms the baseline: Expired tokens return 401. (This distinguishes natural expiry from forced invalidation).,,Not Run,
,,,,,2,Call an API.,API returns 401.,,,,
,,SEC-078,Verify Admin Forced Logout (Deactivate User),Admin is logged in. Target User is logged in.,1,"Admin clicks ""Deactivate"" on the Target User's account.",System confirms deactivation.,The Target User's current token is immediately invalidated. They are kicked out of the session.,,Not Run,
,,,,,2,Target User tries to click a link.,Target User is redirected to Login/Error page.,,,,
,,SEC-079,Verify Different Token Types (Bearer Scheme),User logs out.,1,Send API request with header Authorization: Bearer [Invalidated_Token].,Request sent.,The server validates the signature AND the status. Returns 401.,,Not Run,
,,,,,2,Observe response body.,"Response might say ""Token revoked"" or ""Session expired"".",,,,
,,SEC-080,Verify Performance of Invalidation Check,High load environment.,1,Logout.,Logout successful.,"The invalidation check (e.g., lookup in Redis blacklist) is fast and does not slow down subsequent API calls.",,Not Run,
,,,,,2,Immediately use the token (Race condition check).,The request is blocked instantly.,,,,
,REQ066,SEC-081,Verify Local Storage Clearance upon Logout,User is logged in. DevTools is open (F12) -> Application Tab -> Local Storage.,1,Verify that accessToken (or jwt) exists in Local Storage.,The key accessToken is present with a value.,"After clicking Logout, the accessToken key is completely removed from Local Storage. The value becomes null/undefined.",,Not Run,
,,,,,2,"Click the ""Logout"" button.",The system redirects to the Login Page.,,,,
,,,,,3,Check Local Storage again.,The accessToken key is gone/empty.,,,,
,,SEC-082,Verify Session Storage Clearance upon Logout,"User is logged in. DevTools -> Session Storage. Data (e.g., temp_exam_state) is present.",1,Verify that sensitive keys exist in Session Storage.,Keys like user_session or exam_data are present.,"After clicking Logout, all sensitive keys in Session Storage are cleared immediately.",,Not Run,
,,,,,2,"Click the ""Logout"" button.",The system redirects to the Login Page.,,,,
,,,,,3,Check Session Storage again.,The specific keys are gone/empty.,,,,
,,SEC-083,Verify User Profile Data Removal,"User is logged in. userInfo (Name, Email) is stored in Local Storage for UI display.",1,Check for userInfo object in Local Storage.,The JSON object with user details is visible.,The userInfo data is cleared upon logout to prevent information leakage.,,Not Run,
,,,,,2,"Click the ""Logout"" button.",The system redirects to the Login Page.,,,,
,,,,,3,Check Local Storage.,The userInfo key is removed.,,,,
,,SEC-084,Verify Refresh Token Removal,System uses a refreshToken stored in Local Storage.,1,Check for refreshToken key.,The key is present.,"After clicking Logout, the accessToken key is completely removed from Local Storage. The value becomes null/undefined.",,Not Run,
,,,,,2,"Click the ""Logout"" button.",The system redirects to the Login Page.,,,,
,,,,,3,Check Local Storage.,The refreshToken key is removed.,,,,
,,SEC-085,Verify Multi-Tab Storage Sync (Local Storage),User has Tab A and Tab B open. Both logged in.,1,"In Tab A, click ""Logout"".",Tab A redirects to Login. Local Storage in Tab A is cleared.,Local Storage is cleared across ALL tabs for that domain. Tab B's storage view updates to empty.,,Not Run,
,,,,,2,Switch to Tab B and inspect Local Storage.,The keys are gone in Tab B as well (since LS is shared).,,,,
,,SEC-086,Verify Auto-Logout (Session Timeout) Clearance,User leaves the screen idle until session expires.,1,Wait for the Auto-logout timer to trigger.,The system redirects to Login/Timeout screen.,"The system automatically executes the Clear Storage script upon timeout, just like a manual logout.",,Not Run,
,,,,,2,Check Local/Session Storage.,Sensitive keys are cleared.,,,,
,,SEC-087,Verify Persistence of Non-Sensitive Data (Config),"theme_preference (Dark Mode) is stored in Local Storage. BR66 says ""sensitive data"".",1,Check theme_preference in Local Storage.,"Key is present (e.g., ""dark"").","(Optional) Non-sensitive config data MIGHT remain for UX, while Auth tokens are wiped. (Test confirms design choice).",,Not Run,
,,,,,2,"Click ""Logout"" and check storage.",Auth tokens gone. Theme preference MIGHT remain.,,,,
,,SEC-088,Verify Back Button Data Exposure,User logs out. Storage is cleared.,1,"Click ""Logout"".",Login page loads.,"Even if User clicks ""Back"", the storage remains empty. The browser does not ""restore"" deleted storage keys from history cache.",,Not Run,
,,,,,2,Click Browser Back button.,Browser navigates back (page might crash or redirect).,,,,
,,,,,3,Check Storage immediately.,Keys are NOT restored.,,,,
,,SEC-089,"Verify ""Clear All"" vs ""Remove Item"" Implementation",Application stores 3rd party tracker IDs mixed with App Tokens.,1,"Click ""Logout"".",System executes logout script.,Verify if the code uses localStorage.clear() (Wipes everything) or removeItem(key) (Targeted wipe). Both must result in Auth Token removal.,,Not Run,
,,,,,2,Verify Auth Token status.,Auth Token is definitely gone.,,,,
,,SEC-090,Verify Performance/Speed of Clearance,User clicks Logout.,1,"Click ""Logout"".",The redirect happens.,"The storage clearance happens synchronously before or during redirect, leaving no window where data persists on the Login screen.",,Not Run,
,,,,,2,Check storage on Login screen load.,Storage is already empty.,,,,